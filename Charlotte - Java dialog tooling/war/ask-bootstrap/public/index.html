
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Dialog logs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ask Bootstrap: a compilation of frameworks with handy scripts and styles, ready for cooking a new project or web app immediately.">
    <meta name="author" content="Compiled and maintained by Cengiz Ulusoy. Refer to 'copyrights' section for licences of the components used in this project.">

    <!-- Le styles -->
    <link href="ask-bootstrap/public/src/css/bootstrap.css" rel="stylesheet">
    <link href="ask-bootstrap/public/src/css/responsive.css" rel="stylesheet">
    <link href="ask-bootstrap/public/src/css/datepicker.css" rel="stylesheet">
    <style type="text/css">
        html,
        body {
            height: 100%;
            /* The html and body elements cannot have any padding or margin. */
        }
        body {
            padding-top: 80px;
            padding-bottom: 40px;
        }
            /* Wrapper for page content to push down footer */
        #wrap {
            min-height: 100%;
            height: auto !important;
            height: 100%;
            /* Negative indent footer by it's height */
            margin: 0 auto -60px;
        }

            /* Set the fixed height of the footer here */
        #push,
        #footer {
            height: 20px;
        }
        #footer {
            background-color: #433c2d;
        }

            /* Lastly, apply responsive CSS fixes as necessary */
        @media (max-width: 767px) {
            #footer {
                margin-left: -20px;
                margin-right: -20px;
                padding-left: 20px;
                padding-right: 20px;
            }
        }
    </style>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="shortcut icon" href="ask-bootstrap/public/src/img/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="ask-bootstrap/public/src/img/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="ask-bootstrap/public/src/img/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="ask-bootstrap/public/src/img/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="ask-bootstrap/public/src/img/ico/apple-touch-icon-57-precomposed.png">
</head>

<body>

<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container-fluid">
            <a class="brand" href="ask-bootstrap/public#" style="color: #cccccc">Developer Dialogs/Logs</a>
        </div>
    </div>
</div>

<div id="wrap" class="container-fluid">
    <div>
        <table class="form-inline" id="simpleTable">
            <tr>
                <td style="width:75px;"><label class="span2">Public Key:</label></td>
                <td><input id="pubKey" class="span4" type="text" placeholder="Public key.. "></td>
                <td style="width:75px;"><label class="span2">Private Key:</label></td>
                <td><input id="priKey" class="span4" type="text" placeholder="Private key.. "></td>
                <td style="width:75px;"><label class="span2">AdapterId:</label></td>
                <td><input id="adapterId" class="span4" type="text" placeholder="Adapter Id.. "></td>
            </tr>
        </table>
        <table class="form-inline">
            <tr>
                <td style="width:100px;"><label class="span2">Adapter Type:</label></td>
                <td>
                    <select class="span2" id="adapterType" name="adapterType">
                        <option value="null">All</option>
                        <option value="xmpp">XMPP</option>
                        <option value="call">Call</option>
                        <option value="mail">Mail</option>
                        <option value="sms">SMS</option>
                        <option value="twitter">Twitter</option>
                        <option value="facebook">Facebook</option>
                    </select>
                </td>
                <td style="width:100px;"><label class="span1">Log level:</label></td>
                <td width="20px">
                    <select class="span2" id="logLevel" name="logLevel">
                        <option value="null">All</option>
                        <option value="INFO">Info</option>
                        <option value="DEBUG">Debug</option>
                        <option value="WARNING">Warning</option>
                        <option value="SEVERE">Severe</option>
                    </select>
                </td>
                <td style="width:100px;"><label class="span1">Limit:</label></td>
                <td width="20px">
                    <select class="span1" id="limit" name="limit">
                        <option value="null">No limit</option>
                        <option value="10">10</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </td>
                <td style="width:75px;"><label class="span1">Logs until: </label></td>
                <td style="width:10px;">
                    <div class="input-append date" data-date-format="dd-mm-yyyy">
                        <input width="3px" id="dp1" class="span2" size="16" type="text" placeholder="Pick a date..">
                        <span class="add-on"><i class="icon-th"></i></span>
                    </div>
                </td>
            </tr>
            <tr class="span2"><td> <button class="btn btn-primary" id="search"><i class="icon-white icon-search"></i> Search</button></td></tr>
        </table>
    </div>
    <hr>

    <!--log contents table-->
    <div>
        <table class="form-inline" id="logTable">
            <thead id="logTableHeader" class="span12" style="visibility: hidden; font-weight: bold">
            <tr>
                <td><label class="span2" style="font-weight: bold;">Level</label></td>
                <td><label class="span3" style="font-weight: bold; ">Adapter Id</label></td>
                <td><label class="span2" style="font-weight: bold; ">Adapter Type</label></td>
                <td><label class="span8" style="font-weight: bold; ">Message</label></td>
                <td><label class="span2" style="font-weight: bold; ">Timestamp</label></td>
            </tr>
            </thead>
            <tbody id="logTableBody">
            </tbody>
        </table>
    </div>
</div>
<div id="push"></div>
<div id="footer">
    <div class="container">
        <p class="muted credit" align="center">&copy; Ask Community Solutions 2013</p>
    </div>
</div>


<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="ask-bootstrap/public/src/js/libs/jquery/jquery.js"></script>
<script src="ask-bootstrap/public/src/js/bootstrap-datepicker.js"></script>
<script src="ask-bootstrap/public/src/js/libs/vendor/date.js"></script>
<script>
    $(document).ready(function() {
        $('#dp1').datepicker();
        $('#search').click(function()
        {
            //show processing icon
            $('#logTableBody').html('<tr><td><div class="alert" style="text-align: center">' +
                    '<label style="font-size: medium"> Looking up... </label></div></td></tr>');

            var queryData = '';
            var stringEndDate = $('#dp1').val();
            queryData += 'privateKey=';
            queryData += $.trim($('#priKey').val()) != ''? $('#priKey').val() : '';
            queryData += '&publicKey=';
            queryData += $.trim($('#pubKey').val()) !=''? $('#pubKey').val() :'';
            if($.trim($('#adapterId').val())!='')
            {
                queryData += '&id=' + $.trim($('#adapterId').val());
            }
            if($('#adapterType').val()!= 'null')
            {
                queryData += '&type=' + $('#adapterType').val();
            }
            if($('#logLevel').val()!= 'null')
            {
                queryData += '&level=' + $('#logLevel').val();
            }
            if($.trim(stringEndDate) != '' )
            {
                queryData += '&end=' + Date.parse(stringEndDate).add(1).days().getTime();
            }
            if($('#limit').val()!= 'null')
            {
                queryData += '&limit=' + $('#limit').val();
            }
            $.ajax({
                url: '/log/',
                type: 'GET',
                data: queryData,
                success: showResult,
                error: showError
                });

            function showError(response) {
                $('#logTableHeader').css("visibility", "hidden");
                $('#logTableBody').html('<tr><td><div class="alert" style="text-align: center">' +
                        '<strong style="color: #e2182d">Error! </strong><strong>'+ response.responseText + '</strong></div></td></tr>');
            };

            function showResult(response) {
                //flush the table body
                $('#logTableBody').html("");
                //enable the table
                if(response.length != 0)
                {
                    $('#logTableHeader').css("visibility", "visible");
                }

                var rowData = '';
                for(var logCounter = 0 ; logCounter < response.length; logCounter++)
                {
                    var log = response[logCounter];
                    var logLabel = '';
                    if(log['level'] == 'INFO')
                    {
                        logLabel = '<label style="color: #069317">'+ log['level']+'</label>';
                    }
                    else if(log['level'] == 'DEBUG')
                    {
                        logLabel = '<label style="color: #0f14b3">'+ log['level']+'</label>';
                    }
                    else if(log['level'] == 'WARNING')
                    {
                        logLabel = '<label style="color: #a3a014">'+ log['level']+'</label>';
                    }
                    else if(log['level'] == 'SEVERE')
                    {
                        logLabel = '<label style="color: #db0a1e">'+ log['level']+'</label>';
                    }
                    rowData =   rowData + '<tr class="span12">' +
                            '<td><div class="span2">'+ logLabel +'</div></td> ' +
                            '<td><label class="span3">'+ log['adapterID'] +'</label></td>' +
                            '<td><label class="span2">' + log['adapterType'] +'</label></td>'+
                            '<td><label class="span8">'+ log['message'] +'</label></td>'+
                            '<td><label class="span3">'+ new Date(log['timestamp']).toUTCString() +'</label></td></tr>';
                }
                //load contents to the table
                $('#logTableBody').html(rowData);
            };
        });
    });
</script>
<script src="ask-bootstrap/public/src/js/libs/bootstrap/bootstrap.js"></script>
<script src="ask-bootstrap/public/src/js/libs/vendor/prefixfree.min.js"></script>
</body>
</html>